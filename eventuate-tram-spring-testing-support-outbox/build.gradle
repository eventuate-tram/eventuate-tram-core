dependencies {
    implementation project(":eventuate-tram-spring-producer-jdbc")
    implementation "org.assertj:assertj-core:$assertjVersion"
    implementation "io.eventuate.util:eventuate-util-test:$eventuateUtilVersion"

    compileOnly project(":eventuate-tram-commands")
    compileOnly project(":eventuate-tram-events")

    testImplementation "org.springframework.boot:spring-boot-starter-test:$springBootVersion"
    testImplementation "org.springframework.boot:spring-boot-starter-jdbc:$springBootVersion"
    testImplementation "io.eventuate.common:eventuate-common-testcontainers:$eventuateCommonVersion"
    testImplementation "org.testcontainers:testcontainers:$testContainersVersion"
    testImplementation project(":eventuate-tram-spring-flyway")
    testImplementation project(":eventuate-tram-spring-commands")
    testImplementation project(":eventuate-tram-spring-events-publisher")
}
tasks.withType(Test).configureEach {
    useJUnitPlatform()
    onlyIf {
        // Skip tests when USE_DB_ID is set (testcontainers don't support DB-based ID generation)
        // or when DATABASE is mssql (testcontainers use vanilla databases, not mssql)
        !System.getenv('USE_DB_ID') && System.getenv('DATABASE') != 'mssql'
    }
}